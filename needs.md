# 日语汉字消消乐需求与实现说明（精简+可开发版）

## 1. 项目目标
开发一个基于 Nuxt 3 的日语学习小游戏，通过“汉字-振假名”配对强化记忆。

## 2. 核心玩法
- 左侧展示汉字卡片，右侧展示振假名卡片。
- 用户先点左侧汉字，再点右侧振假名。
- 匹配成功：两张卡片消除，记录该词学习次数 +1。
- 匹配失败：给出红色抖动提示，清空当前选择。
- 所有配对完成后进入结算页。

## 3. 页面需求

### 3.1 首页
- 游戏标题、模式选择、题量选择、开始按钮、统计入口。
- 模式：
  - `新手模式`：优先未学词；不足时补已学词。
  - `复习模式`：优先已学词；不足时补未学词。
- 题量：5 / 10 / 15。

### 3.2 游戏页
- 左右双栏卡片布局，卡片顺序随机。
- 显示进度：剩余配对 / 总配对。
- 退出按钮，二次确认。
- 正确有淡出反馈，错误有抖动反馈。

### 3.3 统计页
- 显示已学单词总数（至少消除一次）。
- 表格显示：汉字、振假名、日语意思、中文意思、例句、例句翻译、累计正确次数、最近学习时间。
- 支持排序（按次数、最近时间、汉字）。
- 支持筛选（全部 / 已学 / 未学）。

### 3.4 结算页
- 显示本轮用时、正确配对数、本轮新学会单词列表。
- 展示本轮全部词条的学习信息：汉字、振假名、日语意思、中文意思、例句、例句翻译。
- 提供“再来一局（沿用相同模式和题量）”与“返回首页”。

## 4. 题库与出题规则
- 数据来源：`parsed_words_11620.json`。
- 每个词包含：`kanji`、`ruby`、`jp_meanings`、`zh_meanings`、`example_sentence`、`example_translation`。
- 出题算法：
  1. 按模式筛选候选词池。
  2. 同一局优先不重复；当词池不足时允许重复并提示。
  3. 左右两列分别独立打乱。

## 5. 学习记录
- 本地持久化：`localStorage`。
- 记录结构：
  - `wordId`
  - `kanji`
  - `ruby`
  - `correctCount`
  - `firstCorrectAt`
  - `lastCorrectAt`
- 刷新或重开浏览器后保留学习进度。

## 6. Clean Architecture 分层

### 6.1 Domain（领域层）
- 实体：`Word`、`LearningRecord`、`GameCard`、`RoundResult`。
- 仓储接口：`IWordRepository`、`ILearningRecordRepository`。
- 值对象：`GameMode`。

### 6.2 Application（应用层）
- 用例：
  - 选择本轮词条（按模式与题量）。
  - 构建卡片板面（左右打乱）。
  - 匹配判断。
  - 正确配对后更新学习记录。
  - 生成统计列表（排序/筛选）。

### 6.3 Infrastructure（基础设施层）
- 题库仓储：从 `parsed_words_11620.json` 读取并规范化。
- 学习仓储：`localStorage` 读写。

### 6.4 Presentation（表现层）
- Pinia Store 负责组装用例与页面状态。
- 页面：`首页`、`游戏页`、`统计页`、`结算页`。
- 组件：模式选择、题量选择、游戏面板等。

## 7. 代码可维护性要求
- 每个文件顶部写明职责。
- 每个函数顶部写明输入、输出、核心逻辑。
- 关键业务判断处写注释（如：出题回填、首次学习判定、结算触发）。
- 命名统一且语义明确，便于 IT 新人阅读与修改。

## 8. 非功能性要求
- 移动端与桌面端都可用。
- 页面反馈清晰，交互无阻塞。
- 不依赖后端，纯前端可运行。

## 9. 本次实现范围
- 已实现：核心流程（首页->游戏->结算->统计）、模式出题、学习记录持久化、排序筛选、结算页/统计页展示词条释义与例句信息。
- 暂不实现（可扩展）：提示点、成就系统、夜间模式、云同步、社交分享。
