rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    /**
     * 每个用户仅可访问自己的备份文档：
     * users/{uid}/backups/learning_records
     */
    match /users/{userId}/backups/{backupId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }

    /** 默认拒绝其他路径，避免误开放。 */
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
